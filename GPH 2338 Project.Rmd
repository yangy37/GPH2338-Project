---
title: "GPH 2338 Project"
author: "Yi Yang"
date: "2023-03-13"
output: pdf_document
---

Data Upload
```{r, message=FALSE, warning=FALSE}
library(haven)
library(psych)
library(caret)
library(tidyverse)
library(ggplot2)
library(psych)
library(pander)
library(corrplot)
library(pander)
library(readr)
library(r02pro)
library(plyr)
library(readr)
```
Data Preparation
```{r}
df<-readr::read_tsv("brca_metabric_clinical_data.tsv")
colnames(df)
colSums(is.na(df))
print(df)

df1 <- df %>% na.omit()
colSums(is.na(df1))
#df1<- df1[df1$`Cancer Type Detailed` == "Breast Invasive Ductal Carcinoma",]

df2<-df1[,-c(1, 2, 3, 6)] # remove StudyID, Patient ID, Sample ID, Cancer Type
print(df2)
dim(df2)

is_categorical <- sapply(df2, is.character)
is_categorical
```

Create Dummy Variable for Categorical Variable
```{r}
df2$Type_of_Breast_Surgery = ifelse(df2$`Type of Breast Surgery` =="BREAST CONSERVING",1,0)
df2$new_Chemotherapy = ifelse(df2$Chemotherapy =="NO",0,1)
for (i in 1:nrow(df2)) {
  if (df2[i,]$Cellularity == "High") {
    df2$new_Cellularity[i] <- 3
  }
  else if (df2[i,]$Cellularity == "Moderate") {
    df2$new_Cellularity[i] <- 2
  }
  else {
    df2$new_Cellularity[i] <- 1
  }
}

for (i in 1:nrow(df2)) {
  if (df2[i,]$`Pam50 + Claudin-low subtype` == "LumA") {
    df2$Pam50_Claudin_low_subtype[i] <- 1
  }
  else if (df2[i,]$`Pam50 + Claudin-low subtype` == "LumB") {
    df2$Pam50_Claudin_low_subtype[i] <- 2
  }
  else if (df2[i,]$`Pam50 + Claudin-low subtype` == "Her2"){
    df2$Pam50_Claudin_low_subtype[i] <- 3
  }
  else if (df2[i,]$`Pam50 + Claudin-low subtype` == "Basal"){
    df2$Pam50_Claudin_low_subtype[i] <- 4
  }
  else if (df2[i,]$`Pam50 + Claudin-low subtype` == "Normal"){
    df2$Pam50_Claudin_low_subtype[i] <- 5
  }
  else if (df2[i,]$`Pam50 + Claudin-low subtype` == "claudin-low"){
    df2$Pam50_Claudin_low_subtype[i] <- 6
  }
  else if (df2[i,]$`Pam50 + Claudin-low subtype` == "NC"){
    df2$Pam50_Claudin_low_subtype[i] <- 7
  }
}


df2$ER_status_measured_by_IHC = ifelse(df2$`ER status measured by IHC` =="Positve",1,0)
df2$ER_Status_Positive = ifelse(df2$`ER Status` =="Positive",1,0)

for (i in 1:nrow(df2)) {
  if (df2[i,]$`HER2 status measured by SNP6` == "NEUTRAL") {
    df2$HER2_status_measured_by_SNP6[i] <- 4
  }
  else if (df2[i,]$`HER2 status measured by SNP6` == "GAIN") {
    df2$HER2_status_measured_by_SNP6[i] <- 3
  }
  else if (df2[i,]$`HER2 status measured by SNP6` == "LOSS"){
    df2$HER2_status_measured_by_SNP6[i] <- 2
  }
  else if (df2[i,]$`HER2 status measured by SNP6` == "UNDEF"){
    df2$HER2_status_measured_by_SNP6[i] <- 1
  }
}
df2$HER2_Status_Positive = ifelse(df2$`HER2 Status` =="Positive",1,0)
for (i in 1:nrow(df2)) {
  if (df2[i,]$`Tumor Other Histologic Subtype` == "Ductal/NST") {
    df2$Tumor_Other_Histologic_Subtype[i] <- 1
  }
  else if (df2[i,]$`Tumor Other Histologic Subtype` == "Mixed") {
    df2$Tumor_Other_Histologic_Subtype[i] <- 2
  }
  else if (df2[i,]$`Tumor Other Histologic Subtype` == "Lobular"){
    df2$Tumor_Other_Histologic_Subtype[i] <- 3
  }
  else if (df2[i,]$`Tumor Other Histologic Subtype` == "Tubular/ cribriform"){
    df2$Tumor_Other_Histologic_Subtype[i] <- 4
  }
  else if (df2[i,]$`Tumor Other Histologic Subtype` == "Mucinous"){
    df2$Tumor_Other_Histologic_Subtype[i] <- 5
  }
  else if (df2[i,]$`Tumor Other Histologic Subtype` == "Medullary"){
    df2$Tumor_Other_Histologic_Subtype[i] <- 6
  }
  else if (df2[i,]$`Tumor Other Histologic Subtype` == "Other"){
    df2$Tumor_Other_Histologic_Subtype[i] <- 7
  }
}

for (i in 1:nrow(df2)) {
  if (df2[i,]$`Oncotree Code` == "IDC") {
    df2$Oncotree_Code[i] <- 4
  }
  else if (df2[i,]$`Oncotree Code` == "MDLC") {
    df2$Oncotree_Code[i] <- 3
  }
  else if (df2[i,]$`Oncotree Code` == "ILC"){
    df2$Oncotree_Code[i] <- 2
  }
  else if (df2[i,]$`Oncotree Code` == "IMMC"){
    df2$Oncotree_Code[i] <- 1
  }
  else if (df2[i,]$`Oncotree Code` == "BREAST"){
    df2$Oncotree_Code[i] <- 5
  }
}

df2$Hormone_Therapy = ifelse(df2$`Hormone Therapy` =="NO",0,1)
df2$Inferred_Menopausal_State = ifelse(df2$`Inferred Menopausal State` =="Pre",0,1)
df2$Primary_Tumor_Laterality = ifelse(df2$`Primary Tumor Laterality` =="Right",0,1)
df2$Overall_Survival_Status = ifelse(df2$`Overall Survival Status` =="1:DECEASED",1,0)
df2$PR_Status = ifelse(df2$`PR Status` =="Positive",1,0)
df2$Radio_Therapy = ifelse(df2$`Radio Therapy` =="NO",0,1)
df2$Relapse_Free_Status = ifelse(df2$`Relapse Free Status` =="0:Not Recurred",0,1)
for (i in 1:nrow(df2)) {
  if (df2[i,]$`3-Gene classifier subtype` == "ER+/HER2- High Prolif") {
    df2$Gene_classifier_subtype[i] <- 4
  }
  else if (df2[i,]$`3-Gene classifier subtype` == "ER+/HER2- Low Prolif") {
    df2$Gene_classifier_subtype[i] <- 3
  }
  else if (df2[i,]$`3-Gene classifier subtype` == "ER-/HER2-"){
    df2$Gene_classifier_subtype[i] <- 2
  }
  else if (df2[i,]$`3-Gene classifier subtype` == "HER2+"){
    df2$Gene_classifier_subtype[i] <- 1
  }
}
for (i in 1:nrow(df2)) {
  if (df2[i,]$`Patient's Vital Status` == "Living") {
    df2$Patients_Vital_Status[i] <- 3
  }
  else if (df2[i,]$`Patient's Vital Status` == "Died of Disease") {
    df2$Patients_Vital_Status[i] <- 2
  }
  else if (df2[i,]$`Patient's Vital Status` == "Died of Other Causes"){
    df2$Patients_Vital_Status[i] <- 1
  }
}

for (i in 1:nrow(df2)) {
  if (df2[i,]$`Integrative Cluster` == "4ER+") {
    df2$Integrative_Cluster[i] <- 4.5
  }
  else if (df2[i,]$`Integrative Cluster` == "9") {
    df2$Integrative_Cluster[i] <- 9
  }
  else if (df2[i,]$`Integrative Cluster` == "7"){
    df2$Integrative_Cluster[i] <- 7
  }
  else if (df2[i,]$`Integrative Cluster` == "3"){
    df2$Integrative_Cluster[i] <- 3
  }
  else if (df2[i,]$`Integrative Cluster` == "10"){
    df2$Integrative_Cluster[i] <- 10
  }
  else if (df2[i,]$`Integrative Cluster` == "8"){
    df2$Integrative_Cluster[i] <- 8
  }
  else if (df2[i,]$`Integrative Cluster` == "6"){
    df2$Integrative_Cluster[i] <- 6
  }
  else if (df2[i,]$`Integrative Cluster` == "1"){
    df2$Integrative_Cluster[i] <- 1
  }
  else if (df2[i,]$`Integrative Cluster` == "2"){
    df2$Integrative_Cluster[i] <- 2
  }
  else if (df2[i,]$`Integrative Cluster` == "5"){
    df2$Integrative_Cluster[i] <- 5
  }
  else if (df2[i,]$`Integrative Cluster` == "4ER-"){
    df2$Integrative_Cluster[i] <- 3.5
  }
}
names(df2)[names(df2) == "Cancer Type Detailed"] <- "Cancer_Type_Detailed"



```


Create Dummy Variable for Numeric Variable
```{r}
names(df2)[names(df2) == "Age at Diagnosis"] <- "Age"
names(df2)[names(df2) == "Neoplasm Histologic Grade"] <- "Neo_Grade"
names(df2)[names(df2) == "Lymph nodes examined positive"] <- "Lymph"
names(df2)[names(df2) == "Mutation Count"] <- "Mutation"
names(df2)[names(df2) == "Nottingham prognostic index"] <- "Nottingham"
names(df2)[names(df2) == "Overall Survival (Months)"] <- "Overall_Month"
names(df2)[names(df2) == "Relapse Free Status (Months)"] <- "Relapse_Month"
names(df2)[names(df2) == "TMB (nonsynonymous)"] <- "TMB"
names(df2)[names(df2) == "Tumor Size"] <- "Tumor_Size"
names(df2)[names(df2) == "Tumor Stage"] <- "Tumor_Stage"
df2
```

```{r}
df3 <- df2[,-c(2,4:6,8,9,11:17,21,23:25,27:32,35)]

pander(summary(df3),caption='Descriptive Statistics of The Data')
```

